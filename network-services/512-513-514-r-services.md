# 512,513,514 - R-services

<table data-header-hidden><thead><tr><th width="124"></th><th width="110"></th><th width="98"></th><th width="94"></th><th></th></tr></thead><tbody><tr><td><strong>Command</strong></td><td><strong>Service Daemon</strong></td><td><strong>Port</strong></td><td><strong>Transport Protocol</strong></td><td><strong>Description</strong></td></tr><tr><td><code>rcp</code></td><td><code>rshd</code></td><td>514</td><td>TCP</td><td>Copy a file or directory bidirectionally from the local system to the remote system (or vice versa) or from one remote system to another. It works like the <code>cp</code> command on Linux but provides <code>no warning to the user for overwriting existing files on a system</code>.</td></tr><tr><td><code>rsh</code></td><td><code>rshd</code></td><td>514</td><td>TCP</td><td>Opens a shell on a remote machine without a login procedure. Relies upon the trusted entries in the <code>/etc/hosts.equiv</code> and <code>.rhosts</code> files for validation.</td></tr><tr><td><code>rexec</code></td><td><code>rexecd</code></td><td>512</td><td>TCP</td><td>Enables a user to run shell commands on a remote machine. Requires authentication through the use of a <code>username</code> and <code>password</code> through an unencrypted network socket. Authentication is overridden by the trusted entries in the <code>/etc/hosts.equiv</code> and <code>.rhosts</code> files.</td></tr><tr><td><code>rlogin</code></td><td><code>rlogind</code></td><td>513</td><td>TCP</td><td>Enables a user to log in to a remote host over the network. It works similarly to <code>telnet</code> but can only connect to Unix-like hosts. Authentication is overridden by the trusted entries in the <code>/etc/hosts.equiv</code> and <code>.rhosts</code> files.</td></tr></tbody></table>

### Service enumeration

The `/etc/hosts.equiv` file contains a list of trusted hosts and is used to grant access to other systems on the network. When users on one of these hosts attempt to access the system, they are automatically granted access without further authentication.

```sh
cat /etc/hosts.equiv

# <hostname> <local username>
host1 bob
```

The `hosts.equiv` file is recognized as the global configuration regarding all users on a system, whereas `.rhosts` provides a per-user configuration

The `+` modifier can be used within these files as a wildcard to specify anything. In this example, the `+` modifier allows any external user to access r-commands from the `bob` user account via the host with the IP address `10.0.17.10`

```sh
cat .rhosts
bob             10.0.17.5
+               10.0.17.10
+               +
```

### Lateral movement

Depending of the entries in those files, we may be able to login to another host without providing a password

```sh
rlogin 10.0.17.2 -l bob
```
